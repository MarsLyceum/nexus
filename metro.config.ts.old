const { getDefaultConfig } = require('@expo/metro-config');
const defaultSourceExts =
    require('metro-config/src/defaults/defaults').sourceExts;

const defaultConfig = getDefaultConfig(__dirname);

const config = {
    ...defaultConfig,
    transformer: {
        getTransformOptions: () => ({
            transform: {
                experimentalImportSupport: false,
                inlineRequires: true,
            },
        }),
    },
    resolver: {
        sourceExts: process.env.RN_SRC_EXT
            ? [
                  ...process.env.RN_SRC_EXT.split(',').concat(
                      defaultSourceExts
                  ),
                  'cjs',
              ] // <-- cjs added here
            : [...defaultSourceExts, 'cjs'], // <-- cjs added here
    },
};

export default config;
